<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
          font-family: 'Segoe UI', sans-serif;
          background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
          min-height: 100vh;
          display: flex;
          flex-direction: column;
        }
        header {
          background: rgba(255,255,255,0.08);
          backdrop-filter: blur(10px);
          padding: 16px 32px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          color: #fff;
        }
        header h2 { font-size: 20px; }
        .btn-logout {
          background: #e74c3c;
          color: #fff;
          border: none;
          padding: 8px 18px;
          border-radius: 8px;
          font-size: 14px;
          cursor: pointer;
          font-weight: 600;
          transition: background 0.2s;
        }
        .btn-logout:hover { background: #c0392b; }
        main {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 40px 16px;
        }
        .card {
          background: #fff;
          border-radius: 16px;
          padding: 40px;
          width: 100%;
          max-width: 460px;
          box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        h1 { text-align: center; color: #0f3460; font-size: 24px; margin-bottom: 30px; }
        .form-group { margin-bottom: 18px; }
        label { display: block; font-size: 14px; font-weight: 600; color: #333; margin-bottom: 6px; }
        input[type="text"] {
          width: 100%;
          padding: 12px 14px;
          border: 2px solid #e0e0e0;
          border-radius: 8px;
          font-size: 15px;
          outline: none;
          transition: border-color 0.2s;
        }
        input:focus { border-color: #0f3460; }
        input.error-border { border-color: #e74c3c; }
        input:disabled {
          background: #f5f5f5;
          color: #555;
          font-weight: 600;
          border-color: #ccc;
        }
        .error-msg { color: #e74c3c; font-size: 12px; margin-top: 5px; display: none; }
        .ops {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 10px;
          margin: 24px 0;
        }
        .btn-op {
          padding: 13px;
          border: none;
          border-radius: 8px;
          font-size: 15px;
          font-weight: 700;
          cursor: pointer;
          transition: transform 0.1s, opacity 0.2s;
        }
        .btn-op:hover { transform: scale(1.05); }
        .btn-op:active { transform: scale(0.97); }
        .btn-add { background: #2ecc71; color: #fff; }
        .btn-sub { background: #e74c3c; color: #fff; }
        .btn-mul { background: #3498db; color: #fff; }
        .btn-div { background: #f39c12; color: #fff; }
        @media (max-width: 400px) {
          .ops { grid-template-columns: repeat(2, 1fr); }
          .card { padding: 24px; }
        }
    </style>
</head>
<body>
<header>
    <h2 id="welcomeMsg">Welcome!</h2>
    <button class="btn-logout" id="logoutBtn">Logout</button>
</header>
<main>
    <div class="card">
        <h1>Calculator</h1>
        <div class="form-group">
            <label for="num1">Number 1</label>
            <input type="text" id="num1" placeholder="Enter first number">
            <div class="error-msg" id="num1-error">Please enter a valid number</div>
        </div>
        <div class="form-group">
            <label for="num2">Number 2</label>
            <input type="text" id="num2" placeholder="Enter second number">
            <div class="error-msg" id="num2-error">Please enter a valid number</div>
        </div>
        <div class="ops">
            <button class="btn-op btn-add" data-op="add">Add</button>
            <button class="btn-op btn-sub" data-op="subtract">Subtract</button>
            <button class="btn-op btn-mul" data-op="multiply">Multiply</button>
            <button class="btn-op btn-div" data-op="divide">Divide</button>
        </div>
        <div class="form-group">
            <label for="result">Result</label>
            <input type="text" id="result" disabled placeholder="Result will appear here">
        </div>
    </div>
</main>
<script>
    const getSession = () => {
      const s = sessionStorage.getItem('userSession') || localStorage.getItem('userSession');
      return s ? JSON.parse(s) : null;
    };

    const session = getSession();
    if (!session || !session.isLoggedIn) {
      window.location.href = 'login.html';
    }

    $('#welcomeMsg').text('Welcome, ' + session.username + '!');

    const calculate = (num1, num2, operation) => {
      if (operation === 'add') return num1 + num2;
      if (operation === 'subtract') return num1 - num2;
      if (operation === 'multiply') return num1 * num2;
      if (operation === 'divide') {
        if (num2 === 0) return 'Error: Division by zero';
        return num1 / num2;
      }
    };

    const isValidNum = val => val.trim() !== '' && /^-?\d+(\.\d+)?$/.test(val.trim());

    const validateInput = (inputId, errorId) => {
      const val = $(inputId).val();
      if (!isValidNum(val)) {
        $(inputId).addClass('error-border');
        $(errorId).show();
        return false;
      }
      $(inputId).removeClass('error-border');
      $(errorId).hide();
      return true;
    };

    $('#num1, #num2').on('focus', function () {
      $(this).removeClass('error-border');
      $(this).next('.error-msg').hide();
    });

    $('.btn-op').on('click', function () {
      const op = $(this).data('op');
      const v1 = validateInput('#num1', '#num1-error');
      const v2 = validateInput('#num2', '#num2-error');
      if (!v1 || !v2) return;

      const n1 = parseFloat($('#num1').val().trim());
      const n2 = parseFloat($('#num2').val().trim());
      const res = calculate(n1, n2, op);

      const display = typeof res === 'number'
        ? (Number.isInteger(res) ? res : parseFloat(res.toFixed(10)))
        : res;

      $('#result').val(display).css('border-color', '#2ecc71');
      setTimeout(() => $('#result').css('border-color', '#ccc'), 1500);
    });

    $('#logoutBtn').on('click', () => {
      sessionStorage.removeItem('userSession');
      localStorage.removeItem('userSession');
      $('main').fadeOut(600, () => { window.location.href = 'login.html'; });
    });
</script>
</body>
</html>