<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
          font-family: 'Segoe UI', sans-serif;
          background: #f0f2f5;
          min-height: 100vh;
          display: flex;
          flex-direction: column;
        }
        header {
          background: #0f3460;
          color: #fff;
          padding: 16px 24px;
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        main {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 40px 16px;
        }
        .card {
          background: #fff;
          border-radius: 8px;
          padding: 40px;
          width: 100%;
          max-width: 440px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { text-align: center; color: #333; margin-bottom: 24px; }
        .form-group { margin-bottom: 16px; }
        label { display: block; font-size: 14px; color: #555; margin-bottom: 4px; }
        input[type="text"] {
          width: 100%;
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 4px;
          font-size: 14px;
          outline: none;
        }
        input.error-border { border-color: #e74c3c; }
        .error-msg { color: #e74c3c; font-size: 12px; margin-top: 4px; display: none; }
        .ops {
          display: grid;
          grid-template-columns: repeat(4,1fr);
          gap: 8px;
          margin: 20px 0;
        }
        .btn-op {
          padding: 12px;
          border: none;
          border-radius: 4px;
          font-size: 14px;
          font-weight: 600;
          cursor: pointer;
          color: #fff;
        }
        .btn-add { background: #2ecc71; }
        .btn-sub { background: #e74c3c; }
        .btn-mul { background: #3498db; }
        .btn-div { background: #f39c12; }
        input:disabled { background: #f5f5f5; }
        .btn-logout {
          background: transparent;
          border: 1px solid #fff;
          color: #fff;
          padding: 6px 14px;
          border-radius: 4px;
          cursor: pointer;
        }
    </style>
</head>
<body>
<header>
    <span id="welcomeMsg">Welcome!</span>
    <button class="btn-logout" id="logoutBtn">Logout</button>
</header>
<main>
    <div class="card">
        <h1>Calculator</h1>
        <div class="form-group">
            <label>Number 1</label>
            <input type="text" id="num1" placeholder="Enter first number">
            <div class="error-msg" id="num1-error">Please enter a valid number</div>
        </div>
        <div class="form-group">
            <label>Number 2</label>
            <input type="text" id="num2" placeholder="Enter second number">
            <div class="error-msg" id="num2-error">Please enter a valid number</div>
        </div>
        <div class="ops">
            <button class="btn-op btn-add" data-op="add">Add</button>
            <button class="btn-op btn-sub" data-op="subtract">Subtract</button>
            <button class="btn-op btn-mul" data-op="multiply">Multiply</button>
            <button class="btn-op btn-div" data-op="divide">Divide</button>
        </div>
        <div class="form-group">
            <label>Result</label>
            <input type="text" id="result" disabled placeholder="Result will appear here">
        </div>
    </div>
</main>
<script>
    const getSession = () => {
      const s = sessionStorage.getItem('userSession') || localStorage.getItem('userSession');
      return s ? JSON.parse(s) : null;
    };

    const session = getSession();
    if (!session || !session.isLoggedIn) window.location.href = 'login.html';
    $('#welcomeMsg').text('Welcome, ' + session.username + '!');

    const calculate = (num1, num2, operation) => {
      if (operation === 'add') return num1 + num2;
      if (operation === 'subtract') return num1 - num2;
      if (operation === 'multiply') return num1 * num2;
      if (operation === 'divide') {
        if (num2 === 0) return 'Error: Division by zero';
        return num1 / num2;
      }
    };

    const isValid = val => val.trim() !== '' && /^-?\d+(\.\d+)?$/.test(val.trim());

    const validateInput = (inputId, errorId) => {
      if (!isValid($(inputId).val())) {
        $(inputId).addClass('error-border');
        $(errorId).show();
        return false;
      }
      $(inputId).removeClass('error-border');
      $(errorId).hide();
      return true;
    };

    $('#num1, #num2').on('focus', function () {
      $(this).removeClass('error-border').next('.error-msg').hide();
    });

    $('.btn-op').on('click', function () {
      const op = $(this).data('op');
      if (!validateInput('#num1', '#num1-error') | !validateInput('#num2', '#num2-error')) return;
      const n1 = parseFloat($('#num1').val().trim());
      const n2 = parseFloat($('#num2').val().trim());
      const res = calculate(n1, n2, op);
      const display = typeof res === 'number' ? (Number.isInteger(res) ? res : parseFloat(res.toFixed(10))) : res;
      $('#result').val(display);
    });

    $('#logoutBtn').on('click', () => {
      sessionStorage.removeItem('userSession');
      localStorage.removeItem('userSession');
      $('main').fadeOut(500, () => { window.location.href = 'login.html'; });
    });
</script>
</body>
</html>